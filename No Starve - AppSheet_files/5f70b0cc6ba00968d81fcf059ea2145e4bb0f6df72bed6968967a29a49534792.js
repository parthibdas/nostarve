"use strict";(self.webpackChunkappsheet_app=self.webpackChunkappsheet_app||[]).push([["components_admin_AdminRoot_tsx"],{202419:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.AvailableComponentsForCustomPolicy=t.AddEditPolicy=void 0;var r=n(a(627424)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=d(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),i=a(558852),c=a(291035),u=a(697211),s=a(695386);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(d=function(e){return e?a:t})(e)}var p=["Security","UserWhiteList","Tables","Columns","Slices","Views","FormatRules","Branding","UXSettings","WorkflowRules","Actions","Tasks","Events","Bots","BehaviorSettings","AppSettings","Description"];t.AvailableComponentsForCustomPolicy=p;var f=(0,s.makeStyles)((function(){return{modalActions:{display:"flex"},cancelButton:{flexGrow:1,marginRight:"8px"},inputGroup:{marginBottom:"16px"}}}));t.AddEditPolicy=function(e){var t,a,n,l,s,d,m,y=f(),E=(0,o.useState)(Object.assign({},e.Policy)),v=(0,r.default)(E,2),g=v[0],h=v[1],b=[c.PolicyTarget.AllApps,c.PolicyTarget.PrototypeApps,c.PolicyTarget.DeployedApps,c.PolicyTarget.ExternalApps],P=function(e,t){return function(a){var n=a.target,l=Object.assign({},e);l[n.name]=n.value,t(l)}}(g,h),C="System"===g.author?null:o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Component:"),o.default.createElement("select",{name:"component",value:g.component,onChange:function(e){return P(e)}},p.map((function(e){return o.default.createElement("option",{value:e,key:e},e)}))));return o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"modal-form"},o.default.createElement("input",{type:"hidden",name:"id",value:g.id}),o.default.createElement("input",{type:"hidden",name:"teamId",value:g.teamId}),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Name:"),o.default.createElement("input",{className:"policy-name",name:"name",type:"text",value:g.name,onChange:function(e){return P(e)},disabled:!e.canEdit})),C,o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Condition:"),o.default.createElement("i",{className:"FormulaIcon fa icon fa-icon fa-fw fa-flask","aria-hidden":"true"}),o.default.createElement("textarea",{name:"constraint",value:g.constraint,onChange:function(e){return P(e)},disabled:!e.canEdit})),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Severity:"),o.default.createElement("select",{name:"severity",value:g.severity,onChange:function(e){return P(e)},disabled:!e.canEdit},o.default.createElement("option",{value:"Error"},"Error"),o.default.createElement("option",{value:"Warning"},"Warning"))),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Target:"),o.default.createElement("select",{name:"target",value:g.target,onChange:function(e){return P(e)},disabled:!e.canEdit},b.map((function(e){return o.default.createElement("option",{value:e,key:e},c.PolicyTargetName[e])})))),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Stage:"),o.default.createElement("select",{name:"stage",value:g.stage,onChange:function(e){return P(e)},disabled:!e.canEdit},o.default.createElement("option",{value:"App_Edit"},"Check on App Edit"),o.default.createElement("option",{value:"Deployment_Check"},"Check on Deployment"),o.default.createElement("option",{value:"Accessing_App"},"Check when your user is using an app"))),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Description:"),o.default.createElement("textarea",{name:"description",value:g.description,onChange:function(e){return P(e)},disabled:!e.canEdit})),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Success Message:"),o.default.createElement("textarea",{name:"messageOnSuccess",value:g.messageOnSuccess,onChange:function(e){return P(e)},disabled:!e.canEdit})),o.default.createElement("div",{className:y.inputGroup},o.default.createElement("label",null,"Failure Message:"),o.default.createElement("textarea",{name:"messageOnFailure",value:g.messageOnFailure,onChange:function(e){return P(e)},disabled:!e.canEdit}))),(t=e.canEdit,a=e.onSave,n=e.onDelete,l=e.onCancel,s=function(e){return 0===e.id}(g)?null:o.default.createElement(u.Tooltip,{title:t?"":"You do not have permission to delete this policy",placement:"top"},o.default.createElement("div",null,o.default.createElement(i.ProgressButton,{renderMaterial:!0,variant:"outlined",color:"error",wrapperClasses:"delete-policy",disabled:!t,onClick:function(){return n(Object.assign({},g))}},"Delete"))),d=o.default.createElement("div",{className:y.cancelButton},o.default.createElement(u.Button,{variant:"outlined",color:"primary",onClick:l},"Cancel")),m=o.default.createElement(u.Tooltip,{title:t?"":"You do not have permission to save this policy",placement:"top"},o.default.createElement("div",null,o.default.createElement(i.ProgressButton,{renderMaterial:!0,wrapperClasses:"save-policy",disabled:!t,onClick:function(){return a(Object.assign({},g))}},"Save"))),o.default.createElement("div",{className:"modal-actions ".concat(y.modalActions)},s,d,m)))}},88850:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.AddEditPolicy2=void 0;var l=n(a(667294)),r=a(202419),o=a(819655),i=a(12053),c=a(229752),u=a(646514),s=(0,c.makeStyles)((function(){return{inputGroup:{marginBottom:"16px"},documentationLink:{color:u.GOOGLE_BLUE}}}));t.AddEditPolicy2=function(e){var t=s(),a=e.policy,n=e.onPolicyChange,c=function(e){var t=e.target,l=Object.assign({},a);l[t.name]=t.value,n(l,t.name)},u="System"===a.author?null:l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Component:"),l.default.createElement("select",{name:"component",value:a.component,onChange:function(e){return c(e)}},r.AvailableComponentsForCustomPolicy.map((function(e){return l.default.createElement("option",{value:e,key:e},e)}))));return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:"modal-form"},l.default.createElement("input",{type:"hidden",name:"id",value:a.id}),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Name:"),l.default.createElement("input",{className:"policy-name",name:"name",type:"text",value:a.name,onChange:function(e){return c(e)},disabled:!e.canEdit})),u,l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Condition:"),l.default.createElement("i",{className:"FormulaIcon fa icon fa-icon fa-fw fa-flask","aria-hidden":"true"}),l.default.createElement("textarea",{name:"constraint",value:a.constraint,onChange:function(e){return c(e)},disabled:!e.canEdit})),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Severity:"),l.default.createElement("select",{name:"severity",value:a.severity,onChange:function(e){return c(e)},disabled:!e.canEdit},l.default.createElement("option",{value:"Error"},"Error"),l.default.createElement("option",{value:"Warning"},"Warning"))),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Target:"),l.default.createElement(i.PolicyTargetSelect,{selectedTarget:a.target,canEdit:e.canEdit,selectedComponent:a.component,handleChange:c})),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Stage:"),l.default.createElement(o.PolicyStageSelect,{selectedStage:a.stage,canEdit:e.canEdit,selectedComponent:a.component,handleChange:c})),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Description:"),l.default.createElement("textarea",{name:"description",value:a.description,onChange:function(e){return c(e)},disabled:!e.canEdit})),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Success Message:"),l.default.createElement("textarea",{name:"messageOnSuccess",value:a.messageOnSuccess,onChange:function(e){return c(e)},disabled:!e.canEdit})),l.default.createElement("div",{className:t.inputGroup},l.default.createElement("label",null,"Failure Message:"),l.default.createElement("textarea",{name:"messageOnFailure",value:a.messageOnFailure,onChange:function(e){return c(e)},disabled:!e.canEdit}))))}},248131:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.ChoosePolicyTemplate=void 0;var r=n(a(627424)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=k(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),i=a(695386),c=a(766333),u=(n(a(178149)),n(a(273463)),n(a(369458)),n(a(507108)),n(a(103736)),n(a(373279))),s=n(a(687217)),d=n(a(722128)),p=n(a(942666)),f=n(a(319337)),m=n(a(768796)),y=n(a(970865)),E=n(a(598045)),v=n(a(938556)),g=n(a(773430)),h=n(a(658177)),b=n(a(143500)),P=n(a(429475)),C=n(a(423301)),w=n(a(42985)),O=(n(a(496486)),a(697211));function k(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(k=function(e){return e?a:t})(e)}var N=(0,i.makeStyles)((function(){return{defaultPolicyCard:{width:"300px",marginBottom:"8px"},cardContent:{textAlign:"left"},cardText:{display:"flex",justifyContent:"center",flexDirection:"column"}}}));new Set(["UserWhiteList","UserDomains","AppSharing","Security"]),new Set(["Tables"]),new Map([["Only users from specific domain",o.default.createElement(u.default,{fontSize:"small",key:1})],["Restrict who can deploy apps",o.default.createElement(s.default,{fontSize:"small",key:2})],["Restrict Prototype Sharing",o.default.createElement(h.default,{fontSize:"small",key:3})],["Restrict Prototype Authentication",o.default.createElement(d.default,{fontSize:"small",key:4})],["Run as-app-creator",o.default.createElement(p.default,{fontSize:"small",key:5})],["Require sign-in policy",o.default.createElement(f.default,{fontSize:"small",key:6})],["Enforce FedRAMP compliance",o.default.createElement(m.default,{fontSize:"small",key:7})],["Prevent row delete",o.default.createElement(y.default,{fontSize:"small",key:8})],["Restrict data source attachable to apps",o.default.createElement(E.default,{fontSize:"small",key:9})],["Restrict providers attachable to apps",o.default.createElement(m.default,{fontSize:"small",key:10})],["Apps must have documentation",o.default.createElement(v.default,{fontSize:"small",key:11})],["Custom policy",o.default.createElement(g.default,{fontSize:"small",key:12})],["Enable offline use",o.default.createElement(b.default,{fontSize:"small",key:13})],["Acceptable image resolution",o.default.createElement(P.default,{fontSize:"small",key:14})],["Must sync-on-start",o.default.createElement(C.default,{fontSize:"small",key:15})],["Disable Chat apps",o.default.createElement(w.default,{fontSize:"small",key:16})]]);t.ChoosePolicyTemplate=function(e){N();var t=e.DefaultPolicies,a=e.onNext,n=(0,o.useState)(null),l=(0,r.default)(n,2),i=l[0],u=l[1],s=function(){var e=t.find((function(e){return e.name===i}));(0,c.assert)(null!=e),a(e)};return o.default.createElement(o.default.Fragment,null,o.default.createElement("label",null,"Policy Template"),o.default.createElement("select",{className:"choose-policy",onChange:function(e){return u(e.target.value)}},o.default.createElement("option",null),t.map((function(e){return o.default.createElement("option",{value:e.name,key:e.name},e.name)}))),o.default.createElement("div",{className:"modal-actions"},o.default.createElement(O.Button,{color:"primary",variant:"contained",className:"template-next",disabled:!i,onClick:s},"Next")))}},937977:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.getSaveModalWarningText=t.getPolicyNumberOfFailuresText=t.getPolicyNumberOfFailuresSecondaryText=t.getNonComplianceTooltipText=t.getMainHeaderSubText=void 0;var l=n(a(667294)),r=a(646514),o=function(e){return new RangeError("This policy is in an invalid state. Stage: ".concat(e.stage,". Severity: ").concat(e.severity,". Component: ").concat(e.component,". Target: ").concat(e.target))};t.getMainHeaderSubText=function(e){var t=l.default.createElement("a",{href:"https://support.google.com/appsheet?p=governance-policies",target:"_blank",rel:"noreferrer",style:{color:r.GOOGLE_BLUE}},"Learn more");if("App_Use"===e.stage&&"Error"===e.severity)return l.default.createElement(l.default.Fragment,null,"Check which apps comply with this policy. Non-compliant apps will become unavailable if the policy is saved. ",t);if("Deployment_Check"===e.stage&&"Error"===e.severity)return l.default.createElement(l.default.Fragment,null,"Check which apps comply with this policy. Non-compliant apps will be shown an error during deployment check. ",t);if("App_Edit"===e.stage&&"Error"===e.severity)return l.default.createElement(l.default.Fragment,null,"Check which apps comply with this policy. An error will be shown to app editors of non-compliant apps. ",t);if("Warning"!==e.severity||"App_Edit"!==e.stage&&"App_Use"!==e.stage){if("Warning"===e.severity&&"Deployment_Check"===e.stage)return l.default.createElement(l.default.Fragment,null,"Check which apps comply with this policy. A warning will be shown to app editors of non-compliant apps during deployment check. ",t);if("Accessing_App"===e.stage)return l.default.createElement(l.default.Fragment,null,"Check which apps comply with this policy.");throw o(e)}return l.default.createElement(l.default.Fragment,null,"Check which apps comply with this policy. A warning will be shown to app editors of non-compliant apps. ",t)};t.getNonComplianceTooltipText=function(e){if("App_Use"===e.stage&&"Error"===e.severity)return"Saving this policy will disable these apps";if("Deployment_Check"===e.stage&&"Error"===e.severity)return"Saving this policy will prevent these apps from being deployed";if("App_Edit"===e.stage&&"Error"===e.severity)return"Saving this policy will show an error to app creators when they edit these apps";if("Warning"!==e.severity||"App_Edit"!==e.stage&&"App_Use"!==e.stage){if("Warning"===e.severity&&"Deployment_Check"===e.stage)return"Saving this policy will show a warning to app creators when these apps are being deployed";if("Accessing_App"===e.stage)return"External apps will be blocked";throw o(e)}return"Saving this policy will show a warning to app creators when they edit these apps"};t.getPolicyNumberOfFailuresText=function(e,t){return"".concat(e," of ").concat(t," App").concat(t>1?"s":""," ").concat(e>1?"are":"is"," out of compliance with this policy")};t.getPolicyNumberOfFailuresSecondaryText=function(e){if("App_Use"===e.stage&&"Error"===e.severity)return"Saving this policy will result in these apps becoming unavailable. If this is not desired, notify app creators or modify the policy.";if("Deployment_Check"===e.stage&&"Error"===e.severity)return"Saving this policy will prevent these apps from being deployed. If this is not desired, notify app creators or modify the policy.";if("App_Edit"===e.stage&&"Error"===e.severity)return"Saving this policy will require app creators to comply with the policy the next time they attempt to make a change to an app. If this is not desired, notify app creators or modify the policy.";if("Warning"!==e.severity||"App_Edit"!==e.stage&&"App_Use"!==e.stage){if("Warning"===e.severity&&"Deployment_Check"===e.stage)return"Saving this policy will warn app creators when they deploy an app. If this is not desired, notify app creators or modify the policy.";if("Accessing_App"===e.stage)return"";throw o(e)}return"Saving this policy will warn app creators when they edit an app. If this is not desired, notify app creators or modify the policy."};t.getSaveModalWarningText=function(e){if("App_Use"===e.stage&&"Error"===e.severity)return"Apps that violate this policy will become unavailable.";if("Deployment_Check"===e.stage&&"Error"===e.severity)return"App creators will be prevented from deploying apps which violate this policy.";if("App_Edit"===e.stage&&"Error"===e.severity)return"App creators will be prevented from saving apps that violate this policy.";if("Warning"!==e.severity||"App_Edit"!==e.stage&&"App_Use"!==e.stage){if("Warning"===e.severity&&"Deployment_Check"===e.stage)return"This will warn app creators when they attempt to deploy an app that violates the policy.";if("Accessing_App"===e.stage)return"Your users may not be able to access apps that they previously had access to.";throw o(e)}return"This will warn app creators when they create or modify an app that violates the policy."}},448249:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyEditor=void 0;var r=n(a(627424)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=P(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),i=a(695386),c=a(88850),u=a(339764),s=a(211336),d=n(a(507108)),p=a(635672),f=n(a(250113)),m=n(a(496486)),y=a(646514),E=a(697211),v=n(a(64858)),g=a(434218),h=a(591915),b=a(558852);function P(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(P=function(e){return e?a:t})(e)}var C=(0,i.makeStyles)((function(){return{gridSection:{padding:"16px;",borderTop:"1px solid ".concat(y.GOOGLE_GREY_200),borderBottom:"1px solid ".concat(y.GOOGLE_GREY_200)},gridSectionLeft:{borderRight:"1px solid ".concat(y.GOOGLE_GREY_200)},modalActions:{display:"flex"},cancelButton:{flexGrow:1,marginRight:"8px"}}})),w=new Set(["constraint","severity","target","stage"]);t.PolicyEditor=function(e){var t=e.canEdit,a=e.onSave,n=e.onCancel,l=e.onDelete,i=C(),y=(0,o.useState)(e.policy),P=(0,r.default)(y,2),O=P[0],k=P[1],N=(0,o.useState)(null),S=(0,r.default)(N,2),_=S[0],A=S[1],x=(0,o.useState)(!0),T=(0,r.default)(x,2),M=T[0],D=T[1],j=(0,o.useState)(!1),L=(0,r.default)(j,2),I=L[0],R=L[1],G=(0,o.useState)(""),W=(0,r.default)(G,2),F=W[0],B=W[1],H=(0,o.useState)(!1),U=(0,r.default)(H,2),z=U[0],Y=U[1],V=(0,o.useState)(!1),q=(0,r.default)(V,2),J=q[0],X=q[1],Z=(0,o.useState)(!1),K=(0,r.default)(Z,2),Q=K[0],$=K[1],ee=(0,o.useCallback)((function(e){return t?(D(!0),(0,p.ajaxPost)("/Account/GetAppsForPolicyCheck",{policy:e},{contentType:"application/json"}).then((function(e){A(e),R(!1)})).catch((function(e){R(!0),B(e.responseJSON.errorMessage),A(null)})).finally((function(){D(!1)}))):Promise.resolve()}),[t]),te=(0,o.useMemo)((function(){return m.default.debounce((function(e){ee(e)}),300)}),[ee]);(0,o.useEffect)((function(){ee(O)}),[ee]);return o.default.createElement(d.default,{container:!0},o.default.createElement(d.default,{item:!0,xs:6,className:"".concat(i.gridSection," ").concat(i.gridSectionLeft)},o.default.createElement(c.AddEditPolicy2,{policy:O,canEdit:t,onPolicyChange:function(e,t){k(e),w.has(t)&&(R(!1),A(null),D(!0),te(e))}})),o.default.createElement(d.default,{item:!0,xs:6,className:i.gridSection},t?I?o.default.createElement(v.default,{id:"compile-error-message",severity:"error",icon:!1},F):M?o.default.createElement("div",{className:"loading",style:{textAlign:"center"}},o.default.createElement(f.default,{color:"primary",size:24})):o.default.createElement(u.PreviewPolicy,{setCanSkipSaveConfirmation:$,policy:O,appsToCheck:_}):o.default.createElement(v.default,{id:"cannot-edit-policies-message",severity:"warning",icon:!1},"You must be an admin to manage team policies.")),o.default.createElement(d.default,{item:!0,xs:12},function(e){var t=null==O||function(e){return 0===e.id}(O)?null:o.default.createElement(E.Tooltip,{title:e?"":"You do not have permission to delete this policy",placement:"top"},o.default.createElement("div",{className:"delete-policy"},o.default.createElement(g.ErrorButton,{variant:"outlined",disabled:!e,onClick:function(){return X(!0)}},"Delete"))),l=o.default.createElement("div",{className:i.cancelButton},o.default.createElement(E.Button,{variant:"outlined",color:"primary",onClick:n},"Cancel")),r=o.default.createElement(E.Tooltip,{title:e?"":"You do not have permission to save this policy",placement:"top"},o.default.createElement("div",null,o.default.createElement(b.ProgressButton,{renderMaterial:!0,variant:"contained",color:"primary",buttonClasses:"save-policy",disabled:I||!e,onClick:function(){return Q?a(Object.assign({},O)):(Y(!0),Promise.resolve())}},"Save")));return o.default.createElement("div",{className:"modal-actions ".concat(i.modalActions)},t,l,r)}(t)),o.default.createElement(s.PolicySaveConfirmationDialog,{show:z,onSave:function(){return a(Object.assign({},O))},onClose:function(){return Y(!1)},policy:O}),o.default.createElement(h.DeletePolicyModal,{show:J,policy:O,onCancel:function(){return X(!1)},onDelete:function(){return l(Object.assign({},O))}}))}},92368:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.didVersionPassCheck=t.didPassCheck=t.PolicyPreviewAppCard=void 0;var l=n(a(667294)),r=a(695386),o=n(a(135851)),i=n(a(507108)),c=a(993476),u=a(646514),s=(0,r.makeStyles)((function(){return{appLogo:{width:"64px"},appCardGrid:{borderBottom:"1px solid ".concat(u.GOOGLE_GREY_300)},appLogoGrid:{maxWidth:"64px",margin:"auto"},appNameOwnerGrid:{margin:"12px 8px 12px 8px"},appNameText:{fontSize:"14px",color:u.GOOGLE_GREY_800,"&:hover":{cursor:"pointer",textDecoration:"underline"}},appOwnerText:{fontSize:"14px",color:u.GOOGLE_GREY_800},chipsGrid:{margin:"auto",maxWidth:"90px"},chip:{fontSize:"14px"},chipTooltip:{cursor:"pointer",marginTop:"2px",marginBottom:"2px"},policyResultIcon:{height:"20px !important",width:"28px !important"},chipLabel:{paddingLeft:"0px"}}})),d=function(e){return null==e||e.checkPassed};t.didVersionPassCheck=d;var p=function(e){return d(e.latestVersionResult)&&d(e.stableVersionResult)};t.didPassCheck=p;t.PolicyPreviewAppCard=function(e){var t=s(),a=e.app,n="Error"===e.severityLevel,r=p(e.appPolicyCheckResult),u="/template/showdef?appId=".concat(a.appId,"&quickStart=False"),f="".concat(u,"&version=").concat(a.stableVersion),m=function(e,t,a,n,r){var i=l.default.createElement(c.PolicyResultIcon,{result:t?"Fail":"Warn",iconClasses:a.policyResultIcon}),u=l.default.createElement(c.PolicyResultIcon,{result:"Pass",iconClasses:a.policyResultIcon}),s=d(e.latestVersionResult),p=d(e.stableVersionResult);return l.default.createElement(l.default.Fragment,null,l.default.createElement(o.default,{label:"Latest",key:"latest",size:"small",variant:"outlined",className:a.chip,classes:{label:a.chipLabel},icon:s?u:i,component:"a",href:n,clickable:!0,target:"_blank",rel:"noopener noreferrer"}),null!=e.stableVersionResult&&l.default.createElement(o.default,{label:"Stable",key:"stable",size:"small",variant:"outlined",className:a.chip,classes:{label:a.chipLabel},icon:p?u:i,component:"a",href:r,clickable:!0,target:"_blank",rel:"noopener noreferrer"}))}(e.appPolicyCheckResult,n,t,u,f);return l.default.createElement(i.default,{container:!0,spacing:0,className:"".concat(t.appCardGrid,"  ").concat(r?"app-policy-check-result-Pass":"app-policy-check-result-Fail")},l.default.createElement(i.default,{item:!0,xs:2,className:t.appLogoGrid},l.default.createElement("img",{src:a.appLogo,className:t.appLogo})),l.default.createElement(i.default,{item:!0,xs:7,className:t.appNameOwnerGrid},l.default.createElement("div",{className:t.appNameText},l.default.createElement("a",{href:u,target:"_blank",rel:"noopener noreferrer"},l.default.createElement("b",null,a.appName))),l.default.createElement("div",{className:t.appOwnerText},a.ownerEmail)),l.default.createElement(i.default,{item:!0,xs:3,className:t.chipsGrid},m))}},993476:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyResultIcon=void 0;var l=n(a(667294)),r=a(695386),o=a(646514),i=n(a(581395)),c=n(a(247298)),u=n(a(521727)),s=(0,r.makeStyles)((function(){return{passColor:{color:o.GOOGLE_GREEN_500},failColor:{color:o.GOOGLE_RED_800},warnColor:{color:o.GOOGLE_YELLOW_800}}}));t.PolicyResultIcon=function(e){var t=s();return"Pass"===e.result?function(e,t){return l.default.createElement(i.default,{className:e.passColor,classes:{root:t}})}(t,e.iconClasses):"Warn"===e.result?function(e,t){return l.default.createElement(u.default,{className:e.warnColor,classes:{root:t}})}(t,e.iconClasses):function(e,t){return l.default.createElement(c.default,{className:e.failColor,classes:{root:t}})}(t,e.iconClasses)}},211336:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicySaveConfirmationDialog=function(e){var t=e.show,a=e.policy,n=e.onSave,o=e.onClose,s=u();return l.default.createElement(r.Dialog,{open:t,className:"policy-save-confirmation-dialog"},l.default.createElement(r.DialogTitle,null,l.default.createElement("b",null,"Save Policy?")),l.default.createElement(r.DialogContent,null,l.default.createElement("p",{className:s.paragraph},(0,c.getSaveModalWarningText)(a)),l.default.createElement("p",{className:s.paragraph},"Are you sure you want to save this policy?")),l.default.createElement(r.DialogActions,null,l.default.createElement(r.Button,{color:"primary",variant:"outlined",onClick:o},"Cancel"),l.default.createElement(i.ProgressButton,{renderMaterial:!0,color:"primary",onClick:n},"Save")))};var l=n(a(667294)),r=a(697211),o=a(695386),i=a(558852),c=a(937977),u=(0,o.makeStyles)((function(){return{paragraph:{paddingBottom:"16px;"}}}))},819655:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyStageSelect=void 0;var l=n(a(667294)),r=new Map([["ExternalAppInfo",["Accessing_App"]]]);t.PolicyStageSelect=function(e){var t=e.selectedStage,a=e.selectedComponent,n=e.handleChange,o=e.canEdit,i=r.get(a),c=null!=i?i:["App_Edit","Deployment_Check","App_Use"];return l.default.createElement("select",{name:"stage",value:t,onChange:n,disabled:!o},c.includes("App_Edit")&&l.default.createElement("option",{value:"App_Edit"},"Check on App Edit"),c.includes("Deployment_Check")&&l.default.createElement("option",{value:"Deployment_Check"},"Check on Deployment"),c.includes("Accessing_App")&&l.default.createElement("option",{value:"Accessing_App"},"Check when your user is using an app"),c.includes("App_Use")&&l.default.createElement("option",{value:"App_Use"},"Enforce always"))}},12053:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyTargetSelect=void 0;var l=n(a(667294)),r=a(291035),o=new Map([["ExternalAppInfo",[r.PolicyTarget.ExternalApps]]]);t.PolicyTargetSelect=function(e){var t=e.selectedTarget,a=e.selectedComponent,n=e.handleChange,i=e.canEdit,c=o.get(a),u=null!=c?c:[r.PolicyTarget.AllApps,r.PolicyTarget.PrototypeApps,r.PolicyTarget.DeployedApps];return l.default.createElement("select",{name:"target",value:t,onChange:n,disabled:!i},u.map((function(e){return l.default.createElement("option",{value:e,key:e},r.PolicyTargetName[e])})))}},339764:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewPolicy=t.MAX_NUM_CONCURRENT_BATCHES=t.BATCH_SIZE=void 0;var r=n(a(600861)),o=n(a(627424)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=S(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),c=n(a(496486)),u=a(697211),s=a(695386),d=a(646514),p=a(635672),f=n(a(593186)),m=a(92368),y=n(a(590503)),E=n(a(935025)),v=n(a(964566)),g=n(a(645432)),h=a(993476),b=n(a(64858)),P=n(a(12354)),C=a(937977),w=a(318926),O=a(29683),k=a(218546),N=a(862858);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(S=function(e){return e?a:t})(e)}var _=(0,s.makeStyles)((function(){return{accordionDetails:{display:"block"},pNoMargin:{marginTop:"0 !important"},numberOfAppsSecondaryText:{marginTop:"12px !important"},subHeaderP:{marginTop:"0 !important",marginBottom:"8px",fontSize:"14px"},contactSupportLink:{textDecoration:"underline",color:d.GOOGLE_BLUE},passColor:{color:d.GOOGLE_GREEN_500},failColor:{color:d.GOOGLE_RED_800},warnColor:{color:d.GOOGLE_YELLOW_800},appsListHeaderDiv:{height:"44px",borderBottom:"1px solid ".concat(d.GOOGLE_GREY_600),cursor:"pointer",marginTop:"8px"},appsListHeaderLineItem:{display:"inline-block !important",height:"36px !important",fontSize:"18px",paddingLeft:"4px",paddingRight:"4px",verticalAlign:"top"},appsListHeaderIcon:{width:"32px !important"},appsListHeaderCarrot:{float:"right",width:"36px !important"},policyCheckProgressAlert:{width:"100% !important"},collapseSection:{marginBottom:"16px"},exposesImageOrFileDataAlert:{marginTop:"16px"},exposesImageOrFileDataAlertIcon:{marginTop:"auto",marginBottom:"auto"},policyPreviewHeader:{marginTop:"0 !important",marginBottom:"8px"}}})),A=function(e,t,a,n){return 0===a.length?null:i.default.createElement("div",{className:"".concat(e.accordionDetails)},a.map((function(e){var a=t.get(e.appId);return i.default.createElement(m.PolicyPreviewAppCard,{key:a.appId,app:a,appPolicyCheckResult:e,severityLevel:n})})))},x=function(e,t){return e.sort((function(e,a){return t.get(e.appId).appName.localeCompare(t.get(a.appId).appName)}))},T=function(e,t,a,n,l,i,c,u){var s=function(e){var t=[],a=[];return e.results.forEach((function(e){(0,m.didPassCheck)(e)?t.push(e):a.push(e)})),[t,a]}(l),d=(0,o.default)(s,2),p=d[0],f=d[1];i((function(e){return x([].concat((0,r.default)(e),(0,r.default)(p)),t)})),c((function(e){return x([].concat((0,r.default)(e),(0,r.default)(f)),t)})),l.exposesImageOrFileData&&u(!0),w.logger.logEvent(new O.LogEvent(k.EventName.PolicyPreviewBatch,{batchNumber:a,startIndex:n,totalNumberOfApps:e.appsToCheck.length,success:!0}))};t.BATCH_SIZE=25;t.MAX_NUM_CONCURRENT_BATCHES=3;var M=function e(t,a,n,l,r,o,i){var c=25*n,u=25*n+25,s=t.appsToCheck.map((function(e){return e.appId})).slice(c,u);return 0===s.length?Promise.resolve():(0,p.ajaxPost)("/Account/CheckPolicy",{appPolicy:t.policy,appIds:s},{contentType:"application/json"}).then((function(e){return T(t,a,n,c,e,l,r,o)})).catch((function(e){w.logger.logEvent(new O.LogEvent(k.EventName.PolicyPreviewBatch,{batchNumber:n,startIndex:c,totalNumberOfApps:t.appsToCheck.length,success:!1})),f.default.ReportError({errorMessage:"CheckPolicy Error",error:e})})).finally((function(){return e(t,a,n+3,l,r,o,i)}))};t.PreviewPolicy=function(e){var t=_(),a=(0,i.useState)(!0),n=(0,o.default)(a,2),l=n[0],r=n[1],s=(0,i.useState)(!0),d=(0,o.default)(s,2),p=d[0],f=d[1],m=(0,i.useState)(!1),O=(0,o.default)(m,2),k=O[0],S=O[1],x=(0,i.useState)((function(){return t=e.appsToCheck,a=new Map,t.forEach((function(e){return a.set(e.appId,e)})),a;var t,a})),T=(0,o.default)(x,1)[0],D=(0,i.useState)([]),j=(0,o.default)(D,2),L=j[0],I=j[1],R=(0,i.useState)([]),G=(0,o.default)(R,2),W=G[0],F=G[1],B=(0,i.useRef)(!1);(0,i.useEffect)((function(){w.logger.startScenario(N.Scenarios.PolicyPreview);var t=c.default.range(3).map((function(t){return M(e,T,t,I,F,S,B)}));return Promise.all(t).then((function(){w.logger.endScenario({result:N.ScenarioResult.Success}),B.current=!0})),function(){B.current||w.logger.endScenario({result:N.ScenarioResult.Abandon,abandonReason:N.ScenarioAbandonReason.UserNavigatedAway})}}),[]);var H,U,z=e.appsToCheck.length,Y=L.length,V=W.length,q=Y+V,J=z-q,X="Error"===e.policy.severity;return(0,i.useEffect)((function(){Y===z&&e.setCanSkipSaveConfirmation(!0)})),i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"modal-form"},i.default.createElement("h4",{className:t.policyPreviewHeader},"Policy compliance preview"),i.default.createElement("p",{className:t.subHeaderP},(0,C.getMainHeaderSubText)(e.policy)),i.default.createElement("div",null,0===z&&i.default.createElement(b.default,{severity:"info",icon:!1},(H=e.policy,U="Org"===H.ownerType?"organization":"Team"===H.ownerType?"team":"account","Your ".concat(U," does not have any apps"))),J>0&&i.default.createElement(b.default,{severity:"info",icon:!1,classes:{message:t.policyCheckProgressAlert}},i.default.createElement("div",null,"Checked ",q," of ",z," apps"),i.default.createElement(u.LinearProgress,{variant:"determinate",value:100*q/z})),0===V&&0===J&&Y>0&&i.default.createElement(b.default,{severity:"success",icon:!1},"All apps passed the policy check"),V>0&&0===J&&i.default.createElement(i.default.Fragment,null,i.default.createElement(b.default,{severity:X?"error":"warning",icon:!1},i.default.createElement("p",{className:t.pNoMargin},(0,C.getPolicyNumberOfFailuresText)(V,z)),i.default.createElement("p",{className:t.numberOfAppsSecondaryText},(0,C.getPolicyNumberOfFailuresSecondaryText)(e.policy))),k&&i.default.createElement(b.default,{className:t.exposesImageOrFileDataAlert,classes:{icon:t.exposesImageOrFileDataAlertIcon},severity:"error"},i.default.createElement("p",{className:"".concat(t.pNoMargin," exposesImageOrFileDataWarning")},"For certain apps, image and file serving may not be completely shut down."," ",i.default.createElement("a",{href:"https://support.google.com/appsheet/gethelp",className:t.contactSupportLink,target:"_blank",rel:"noopener noreferrer"},"Contact AppSheet Support")," ","if you need assistance.")))),V>0&&i.default.createElement("div",{className:t.appsListHeaderDiv,onClick:function(){return r(!l)}},i.default.createElement(h.PolicyResultIcon,{result:X?"Fail":"Warn",iconClasses:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderIcon)}),i.default.createElement("h3",{className:t.appsListHeaderLineItem},"Non-compliant (",V,")"),i.default.createElement(P.default,{title:(0,C.getNonComplianceTooltipText)(e.policy),placement:"bottom-start"},i.default.createElement(g.default,{className:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderIcon)})),l?i.default.createElement(E.default,{className:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderCarrot)}):i.default.createElement(v.default,{className:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderCarrot)})),i.default.createElement(y.default,{in:l,className:t.collapseSection},A(t,T,W,e.policy.severity)),Y>0&&i.default.createElement("div",{className:t.appsListHeaderDiv,onClick:function(){return f(!p)}},i.default.createElement(h.PolicyResultIcon,{result:"Pass",iconClasses:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderIcon)}),i.default.createElement("h3",{className:t.appsListHeaderLineItem},"Compliant (",Y,")"),i.default.createElement(P.default,{title:"Apps will continue to work as intended. No further action required",placement:"bottom-start"},i.default.createElement(g.default,{className:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderIcon)})),p?i.default.createElement(E.default,{className:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderCarrot)}):i.default.createElement(v.default,{className:"".concat(t.appsListHeaderLineItem," ").concat(t.appsListHeaderCarrot)})),i.default.createElement(y.default,{in:p,className:t.collapseSection},A(t,T,L,e.policy.severity))))}},561723:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.AdminRoot=function(e){var t=e.teamRollouts;return l.default.createElement(r.BrowserRouter,null,l.default.createElement(r.Switch,null,l.default.createElement(r.Route,{path:u},l.default.createElement(o.PoliciesDashboard,{teamRollouts:t})),l.default.createElement(r.Route,{path:c},l.default.createElement(o.PoliciesDashboard,{teamRollouts:t})),l.default.createElement(r.Route,{path:i},l.default.createElement(r.Redirect,{to:s("account")}))))},t.POLICIES_TEAM_ROUTE=t.POLICIES_ROUTE=t.POLICIES_DEFAULT_ROUTE=void 0,t.getPoliciesDashboardRoute=s;var l=n(a(667294)),r=a(558801),o=a(40586),i="/admin/policies";t.POLICIES_DEFAULT_ROUTE=i;var c="".concat(i,"/:scope");t.POLICIES_ROUTE=c;var u="".concat(i,"/:scope/:id");function s(e,t){return t?"/admin/policies/".concat(e,"/").concat(t):"/admin/policies/".concat(e)}t.POLICIES_TEAM_ROUTE=u},463182:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.AddEditPolicyModal=function(e){var t=e.scope,a=e.teamId,n=e.show,l=e.policy,p=e.defaultPolicies,f=e.onClose,m=e.onSave,y=e.onDelete,E=e.onError,v=e.canEdit,g=e.teamRollouts,h=(0,o.useState)(null),b=(0,r.default)(h,2),P=b[0],C=b[1],w=(0,o.useCallback)((function(){C(null),f()}),[f]),O=(0,o.useCallback)((function(e){return(0,s.ajaxPost)("/Account/AddOrUpdatePolicy",e).then(m).then(w).catch(E)}),[m,w,E]),k=(0,o.useCallback)((function(e){return(0,s.ajaxDelete)("/Account/DeletePolicy?policyId=".concat(e.id)).then(y).then(w).catch(E)}),[y,w,E]),N=(0,o.useCallback)((function(e){g.policyPreviewRollout?C(o.default.createElement(c.default,{onClose:w,title:"Define an App Policy",className:"add-edit-policy-modal",contentClassName:"preview-modal-content",bodyClassName:"preview-modal-body"},o.default.createElement(d.PolicyEditor,{policy:e,canEdit:v,onSave:function(e){return O(e)},onDelete:function(e){return k(e)},onCancel:function(){C(null)}}))):C(o.default.createElement(c.default,{onClose:w,title:"Define an App Policy",className:"add-edit-policy-modal"},o.default.createElement(u.AddEditPolicy,{Policy:e,canEdit:v,onSave:O,onDelete:k,onCancel:w})))}),[w,v,O,k,g.policyPreviewRollout]),S=(0,o.useCallback)((function(){C(o.default.createElement(c.default,{onClose:w,title:"Define an App Policy"},o.default.createElement(i.ChoosePolicyTemplate,{onNext:function(e){e.ownerType=function(e){switch(e){case"account":return"User";case"team":return"Team";case"org":return"Org"}throw new Error("policy scope ".concat(e," not recognized!"))}(t),e.teamId=a,N(e)},DefaultPolicies:p,teamRollouts:g})))}),[w,p,t,N,g,a]);return(0,o.useEffect)((function(){n&&(null!=l?N(l):S())}),[n,S,l,N]),o.default.createElement(o.default.Fragment,null,P)};var r=n(a(627424)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=p(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),i=a(248131),c=n(a(769938)),u=a(202419),s=a(635672),d=a(448249);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(p=function(e){return e?a:t})(e)}},591915:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.DeletePolicyModal=function(e){var t=e.show,a=e.policy,n=e.onCancel,c=e.onDelete,u=i();if(null==a)return l.default.createElement(l.default.Fragment,null);return l.default.createElement(r.Dialog,{open:t},l.default.createElement(r.DialogTitle,null,"Delete Policy"),l.default.createElement(r.DialogContent,null,l.default.createElement("div",null,"Are you sure you want to delete this policy?"),l.default.createElement("div",{className:u.policyName},a.name),l.default.createElement("div",{className:u.policyDetail},a.description)),l.default.createElement(r.DialogActions,null,l.default.createElement(r.Button,{color:"primary",variant:"outlined",onClick:n},"Cancel"),l.default.createElement(o.ProgressButton,{renderMaterial:!0,color:"error",onClick:c},"Delete Policy")))};var l=n(a(667294)),r=a(697211),o=a(558852),i=(0,a(229752).makeStyles)((function(){return(0,r.createStyles)({policyName:{fontWeight:"bold",margin:"16px 0 4px 0"},policyDetail:{color:"#616161"}})}))},40586:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.PoliciesDashboard=function(e){var t=(0,d.useParams)(),a=t.scope,n=t.id,l=isFinite(Number(n))?Number(n):0,y=(0,o.useReducer)(v,E),P=(0,r.default)(y,2),C=P[0],w=P[1],O=(0,d.useHistory)(),k=C.policies,N=C.loading,S=C.showError,_=C.errorMessage;return(0,o.useEffect)((function(){null==k||"team"!==a||g(l,k)||O.push((0,m.getPoliciesDashboardRoute)("account"))}),[k,a,l,O]),(0,o.useEffect)((function(){null==k&&(0,s.ajaxGet)("/account/apppolicies").then((function(e){w({type:"loadPolicies",policies:e})})).catch((function(e){var t,a;w({type:"showError",errorMessage:null!==(a=null===(t=e.responseJSON)||void 0===t?void 0:t.errorMessage)&&void 0!==a?a:"An unexpected error occured"})}))}),[k]),o.default.createElement("div",{className:"dashboard-page"},o.default.createElement("div",{className:"policy-header"},o.default.createElement("div",null,o.default.createElement("h2",{className:"page-title"},"Policies"),o.default.createElement("p",null,"Use policies for app design consistency and compliance. ",o.default.createElement("a",{className:"learn-more",href:"https://support.google.com/appsheet?p=governance-policies"},"Learn more")))),k&&o.default.createElement("div",{className:"dashboard-container"},o.default.createElement(p.PolicyTreePane,{scope:a,policies:k}),o.default.createElement(f.PolicyDetailPane,{scope:a,teamId:l,title:b(a,l,k),dispatch:w,policies:h(a,l,k),hasTeamAdminPermission:k.hasTeamAdminPermission,hasOrgAdminPermission:k.hasOrgAdminPermission,defaultPolicies:k.defaultPolicies,teamRollouts:e.teamRollouts})),N&&o.default.createElement(i.LoadingSpinner,null),o.default.createElement(c.default,{open:S,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:5e3,onClose:function(){return w({type:"hideError"})}},o.default.createElement(u.default,{severity:"error"},_)))};var r=n(a(627424)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=y(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),i=a(851982),c=n(a(121786)),u=n(a(64858)),s=a(635672),d=a(558801),p=a(841117),f=a(234390),m=a(561723);function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(y=function(e){return e?a:t})(e)}var E={policies:null,loading:!0,showError:!1,errorMessage:"An error occured"};function v(e,t){switch(t.type){case"loadPolicies":return Object.assign(Object.assign({},e),{policies:t.policies,loading:!1});case"clearPolicies":return Object.assign(Object.assign({},e),{policies:null,loading:!0});case"showError":return Object.assign(Object.assign({},e),{showError:!0,errorMessage:t.errorMessage,loading:!1});case"hideError":return Object.assign(Object.assign({},e),{showError:!1});default:return e}}function g(e,t){if(0!==e)return e===t.teamId?t:t.orgTeamPolicies.find((function(t){return t.teamId===e}))}function h(e,t,a){var n;switch(e){case"account":return a.userPolicies;case"team":var l=g(t,a);return null!==(n=null==l?void 0:l.teamPolicies)&&void 0!==n?n:[];case"org":return a.orgPolicies;default:throw new Error("Policy scope ".concat(e," not recognized"))}}function b(e,t,a){var n;switch(e){case"account":return"Account";case"team":var l=g(t,a);return null!==(n=null==l?void 0:l.teamName)&&void 0!==n?n:"";case"org":return a.orgName;default:throw new Error("Policy scope ".concat(e," not recognized"))}}},234390:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyDetailPane=function(e){var t=e.scope,a=e.teamId,n=e.title,l=e.dispatch,v=e.policies,h=e.defaultPolicies,b=e.hasTeamAdminPermission,P=e.hasOrgAdminPermission,C=(0,o.useState)(!1),w=(0,r.default)(C,2),O=w[0],k=w[1],N=(0,o.useState)(!1),S=(0,r.default)(N,2),_=S[0],A=S[1],x=(0,o.useState)(null),T=(0,r.default)(x,2),M=T[0],D=T[1],j=g(t,b,P),L=(0,o.useCallback)((function(e){return(0,m.ajaxDelete)("/Account/DeletePolicy?policyId=".concat(e.id)).then((function(){return l({type:"clearPolicies"})})).catch((function(e){var t,a;return l({type:"showError",errorMessage:null!==(a=null===(t=e.responseJSON)||void 0===t?void 0:t.errorMessage)&&void 0!==a?a:"An unexpected error occured"})}))}),[l]),I=0===v.length?o.default.createElement("div",{className:"detail-empty"},"No policies"):o.default.createElement(i.TableContainer,null,o.default.createElement(i.Table,{"aria-label":"policies table"},o.default.createElement(i.TableHead,null,o.default.createElement(i.TableRow,null,o.default.createElement(i.TableCell,null,"Name"),o.default.createElement(i.TableCell,null,"Last modified"),o.default.createElement(i.TableCell,null))),o.default.createElement(i.TableBody,null,v.map((function(e){return o.default.createElement(i.TableRow,{key:e.id,className:"policy-row",onClick:function(){D(e),k(!0)}},o.default.createElement(i.TableCell,null,o.default.createElement("div",null,e.name),o.default.createElement("div",{className:"policy-detail"},e.description)),o.default.createElement(i.TableCell,null,e.lastUpdated),o.default.createElement(i.TableCell,{className:"policy-overflow"},j&&o.default.createElement(y.IconMenu,{icon:p.default},o.default.createElement(i.MenuItem,{disabled:!j,onClick:function(t){t.stopPropagation(),D(e),k(!0)}},o.default.createElement(i.ListItemIcon,null,o.default.createElement(d.default,null)),o.default.createElement(i.ListItemText,null,"Edit")),o.default.createElement(i.MenuItem,{disabled:!j,onClick:function(t){t.stopPropagation(),D(e),A(!0)}},o.default.createElement(i.ListItemIcon,null,o.default.createElement(s.default,null)),o.default.createElement(i.ListItemText,null,"Delete")))))})))));return o.default.createElement("div",{className:"pane-container detail-pane"},o.default.createElement("div",{className:"pane-header detail-header"},o.default.createElement("div",{className:"pane-header-title"},o.default.createElement("span",null,n)),o.default.createElement(i.Tooltip,{title:j?"":"You do not have permission to add a policy"},o.default.createElement("div",null,o.default.createElement(i.Button,{color:"primary",disabled:!j,onClick:function(){D(null),k(!0)}},o.default.createElement(u.default,null),o.default.createElement("span",null,"".concat((0,c.getPolicyScopeLabel)(t)," policy")))))),o.default.createElement("div",{className:"pane-body"},I),o.default.createElement(f.AddEditPolicyModal,{show:O,scope:t,teamId:a,policy:M,canEdit:j,defaultPolicies:h,onClose:function(){return k(!1)},onSave:function(){return l({type:"clearPolicies"})},onDelete:function(){return l({type:"clearPolicies"})},onError:function(e){var t,a;return l({type:"showError",errorMessage:null!==(a=null===(t=e.responseJSON)||void 0===t?void 0:t.errorMessage)&&void 0!==a?a:"An unexpected error occured"})},teamRollouts:e.teamRollouts}),o.default.createElement(E.DeletePolicyModal,{show:_,policy:M,onCancel:function(){return A(!1)},onDelete:function(){return L(M).then((function(){return A(!1)}))}}))},t.canEditPolicy=g;var r=n(a(627424)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=v(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),i=a(697211),c=a(44532),u=n(a(773430)),s=n(a(996733)),d=n(a(309108)),p=n(a(864126)),f=a(463182),m=a(635672),y=a(682286),E=a(591915);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(v=function(e){return e?a:t})(e)}function g(e,t,a){return(!a||"team"!==e)&&(!!a||(!("team"!==e||!t)||"account"===e))}},841117:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyTreePane=function(e){var t=e.scope,a=e.policies,n=a.orgName,u=a.teamId,f=a.hasOrgAdminPermission,m=a.orgTeamPolicies,y=!!n,E=p(),v=f&&"team"===t?"org":t;return l.default.createElement("div",{className:"pane-container tree-pane ".concat(E.policyPane)},l.default.createElement("div",{className:"pane-header"},l.default.createElement("div",{className:"pane-header-title"},"Policies by scope")),l.default.createElement("div",{className:"pane-body"},l.default.createElement(r.TreeView,{defaultCollapseIcon:l.default.createElement(o.default,null),defaultExpandIcon:l.default.createElement(i.default,null),expanded:["org"],selected:v},y&&l.default.createElement(r.TreeItem,{nodeId:"org",label:l.default.createElement("div",{className:"node-label"},l.default.createElement("i",{className:"material"},"public"),l.default.createElement(c.Link,{to:(0,d.getPoliciesDashboardRoute)("org")},(0,s.getPolicyScopeLabel)("org")))},f&&m.map((function(e){return l.default.createElement(r.TreeItem,{key:e.teamId,nodeId:String(e.teamId),label:l.default.createElement("div",{className:"node-label"},l.default.createElement("i",{className:"material"},"team_drive"),l.default.createElement(c.Link,{to:(0,d.getPoliciesDashboardRoute)("team",e.teamId)},e.teamName))})}))),!f&&l.default.createElement(r.TreeItem,{nodeId:"team",label:l.default.createElement("div",{className:"node-label"},l.default.createElement("i",{className:"material"},"team_drive"),l.default.createElement(c.Link,{to:(0,d.getPoliciesDashboardRoute)("team",u)},(0,s.getPolicyScopeLabel)("team")))}),l.default.createElement(r.TreeItem,{nodeId:"account",label:l.default.createElement("div",{className:"node-label"},l.default.createElement("i",{className:"material"},"person"),l.default.createElement(c.Link,{to:(0,d.getPoliciesDashboardRoute)("account")},(0,s.getPolicyScopeLabel)("account")))}))))};var l=n(a(667294)),r=a(400078),o=n(a(289039)),i=n(a(252504)),c=a(558801),u=a(229752),s=a(44532),d=a(561723),p=(0,u.makeStyles)({policyPane:{minWidth:"200px"}})},44532:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPolicyScopeLabel=function(e){switch(e){case"team":return"Team";case"account":return"Account";case"org":return"Organization";default:throw new Error("Unrecognized policy scope ".concat(e))}}},434218:(e,t,a)=>{var n=a(564836);Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorButton=function(e){var t=i(),a="";if("contained"===e.variant)a=t.containedError;else a=t.outlinedError;return o.default.createElement(l.Button,Object.assign({className:a},e),e.children)};var l=a(697211),r=a(695386),o=n(a(667294)),i=(0,r.makeStyles)((function(e){return(0,l.createStyles)({outlinedError:{borderColor:e.palette.error.main,color:e.palette.error.main},containedError:{backgroundColor:e.palette.error.main,color:e.palette.error.contrastText,"&:hover":{backgroundColor:e.palette.error.dark}}})}))},682286:(e,t,a)=>{var n=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.IconMenu=function(e){var t=e.children,a=(0,o.useAnchorEl)();return l.default.createElement(l.default.Fragment,null,l.default.createElement(r.IconButton,{"aria-haspopup":"true","aria-label":"Icon menu button",onClick:function(e){e.stopPropagation(),a.set(e)}},l.default.createElement(e.icon,null)),l.default.createElement(r.Menu,{anchorEl:a.element,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0,open:a.isOpen,onClose:function(e,t){e.stopPropagation(),a.clear()}},l.Children.map(t,(function(e){return(0,i.assert)(l.default.isValidElement(e)),(0,l.cloneElement)(e,{onClick:function(t){e.props.onClick(t),a.clear()}})}))))};var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var l={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(l,o,i):l[o]=e[o]}l.default=e,a&&a.set(e,l);return l}(a(667294)),r=a(697211),o=a(7207),i=a(766333);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}},769938:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.ModalBody=function(e){var t=e.children;return r.default.createElement("div",{className:"modal-body"},t)},t.ModalFooter=function(e){var t=e.children;return r.default.createElement("div",{className:"modal-footer"},t)},t.default=function(e){var t=e.children,a=e.title,n=e.onClose,l=e.className,c=e.bodyClassName,u=e.contentClassName;return(0,r.useEffect)((function(){var e=function(e){"Escape"===e.key&&n()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}})),r.default.createElement("div",{onClick:function(e){return e.stopPropagation()},className:l?"modal ".concat(l):"modal",style:{zIndex:1200,display:"block"}},r.default.createElement("div",{className:"modal-backdrop"}),r.default.createElement("div",{className:"modal-dialog",role:"dialog"},r.default.createElement("div",{className:"modal-content"+(u?" ".concat(u):"")},r.default.createElement("div",{className:"modal-header"},r.default.createElement("h4",{className:"modal-title"},a),r.default.createElement(i.IconButton,{onClick:n,className:"close-modal-icon-button"},r.default.createElement(o.default,null))),r.default.createElement("div",{className:"modal-body"+(c?" ".concat(c):"")},t))))};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294)),o=n(a(480366)),i=a(697211);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}},558852:(e,t,a)=>{var n=a(564836),l=a(918698);Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressButton=function(e){var t=e.buttonClasses,a=void 0===t?"":t,n=e.wrapperClasses,l=void 0===n?"":n,c=e.onClick,s=e.disabled,d=void 0!==s&&s,p=e.variant,f=void 0===p?"contained":p,m=e.color,y=void 0===m?"primary":m,E=e.renderMaterial,v=void 0!==E&&E,g=e.children,h=u(),b=(0,i.useState)(!1),P=(0,r.default)(b,2),C=P[0],w=P[1],O=["default","inherit","primary","secondary"].indexOf(y)>-1?y:void 0,k="";O||("contained"===f&&"error"===y?k=h.containedError:"outlined"===f&&"error"===y&&(k=h.outlinedError));var N=i.default.useRef(!1);i.default.useEffect((function(){return N.current=!0,function(){N.current=!1}}),[]);var S=function(e){w(!0),c(e).finally((function(){N.current&&w(!1)}))};return i.default.createElement("div",{className:"".concat(h.wrapper," ").concat(l)},v?i.default.createElement(o.Button,{variant:f,color:O,className:k,onClick:S,disabled:C||d},g):i.default.createElement("button",{className:a,onClick:S,disabled:C||d},g),C&&i.default.createElement(o.CircularProgress,{color:"primary",size:24,className:h.progress}))};var r=n(a(627424)),o=a(697211),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(667294));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}var u=(0,a(695386).makeStyles)((function(e){return(0,o.createStyles)({wrapper:{position:"relative",display:"inline-block"},progress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},outlinedError:{borderColor:e.palette.error.main,color:e.palette.error.main},containedError:{backgroundColor:e.palette.error.main,color:e.palette.error.contrastText,"&:hover":{backgroundColor:e.palette.error.dark}}})}))},291035:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyTargetName=t.PolicyTarget=void 0;var a;t.PolicyTargetName={0:"All Apps",1:"Deployed Apps",2:"Prototype Apps",3:"External Apps"},t.PolicyTarget=a,function(e){e[e.AllApps=0]="AllApps",e[e.DeployedApps=1]="DeployedApps",e[e.PrototypeApps=2]="PrototypeApps",e[e.ExternalApps=3]="ExternalApps"}(a||(t.PolicyTarget=a={}))}}]);
//# sourceMappingURL=/cloud-sources/prod/109d411179e3d4620d159a3ddc39895f3915a27cda3488d63007fd91aecf93fb.map/